<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Manage Videos</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Manage Videos</h1>
        <form id="videoForm">
            <label for="video1">Video URL 1:</label>
            <input type="text" id="video1" name="video1"><br>
            <label for="video2">Video URL 2:</label>
            <input type="text" id="video2" name="video2"><br>
            <label for="video3">Video URL 3:</label>
            <input type="text" id="video3" name="video3"><br>
            <label for="video4">Video URL 4:</label>
            <input type="text" id="video4" name="video4"><br>
            <label for="video5">Video URL 5:</label>
            <input type="text" id="video5" name="video5"><br>
            <label for="downloadUrl">Download URL:</label>
            <input type="text" id="downloadUrl" name="downloadUrl"><br>
            <button type="submit">Save</button>
        </form>
        <p id="statusMessage"></p>
    </div>

    <!-- Firebase SDK via CDN -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDDB8wgUqtfZUHx0qc6xT97L7oBp-k9nns",
            authDomain: "viral-cok.firebaseapp.com",
            projectId: "viral-cok",
            storageBucket: "viral-cok.firebasestorage.app",
            messagingSenderId: "465866226747",
            appId: "1:465866226747:web:cbe62190014be0f1bcf01e"
        };

        const app = initializeApp(firebaseConfig);
        window.firestoreDb = getFirestore(app);
    </script>

    <!-- Admin Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const db = window.firestoreDb;
            if (!db) {
                alert('Database tidak tersedia.');
                return;
            }

            // Muat data yang ada
            db.collection('videos').doc('list').get().then(doc => {
                if (doc.exists) {
                    const data = doc.data();
                    document.getElementById('video1').value = data.urls[0] || '';
                    document.getElementById('video2').value = data.urls[1] || '';
                    document.getElementById('video3').value = data.urls[2] || '';
                    document.getElementById('video4').value = data.urls[3] || '';
                    document.getElementById('video5').value = data.urls[4] || '';
                }
            }).catch(error => {
                alert('Gagal memuat data video.');
            });

            db.collection('settings').doc('download').get().then(doc => {
                if (doc.exists) {
                    document.getElementById('downloadUrl').value = doc.data().url || '';
                }
            }).catch(error => {
                alert('Gagal memuat link download.');
            });

            // Simpan data
            document.getElementById('videoForm').addEventListener('submit', e => {
                e.preventDefault();
                const videos = [
                    document.getElementById('video1').value,
                    document.getElementById('video2').value,
                    document.getElementById('video3').value,
                    document.getElementById('video4').value,
                    document.getElementById('video5').value
                ];
                const downloadUrl = document.getElementById('downloadUrl').value;

                Promise.all([
                    db.collection('videos').doc('list').set({ urls: videos }),
                    db.collection('settings').doc('download').set({ url: downloadUrl })
                ]).then(() => {
                    document.getElementById('statusMessage').textContent = 'Data berhasil disimpan!';
                }).catch(error => {
                    alert('Gagal menyimpan data.');
                });
            });
        });
    </script>
</body>
</html>